<?xml version="1.0" encoding="utf-16"?>
<ZL_OBJECT CHECKSUM="FFD7C571B4B5FF31B565C85C6EBFC362" CONNECTOR="AAAD0A4B07A5A05AE1000000AC120173" NAME="ZAPLINK_INSTALLER_MASTER" TYPE="PROG" VERSION="1.0">
 <DIRECTORY SRCSYSTEM="OD4" AUTHOR="TBENSIAL" DEVCLASS="ZAPLINK-INSTALLER" MASTERLANG="E"/>
 <RAW>
  <A0_MAIN NAME="ZAPLINK_INSTALLER_MASTER" VARCL="X" SUBC="1" CNAM="TBENSIAL" CDAT="20091120" UNAM="TBENSIAL" UDAT="20100114" VERN="000005" RSTAT="K" RMAND="200" RLOAD="E" FIXPT="X" SDATE="20100114" STIME="140519" IDATE="20100114" ITIME="140519" UCCHECK="X"/>
  <SOURCE>*&amp;amp;---------------------------------------------------------------------*
*&amp;amp; Report  ZAPLINK_INSTALLER_MASTER
*&amp;amp;
*&amp;amp;---------------------------------------------------------------------*
*&amp;amp;
*&amp;amp;
*&amp;amp;---------------------------------------------------------------------*

REPORT  zaplink_installer_master MESSAGE-ID zaplink_cx.

INCLUDE zaplink_installer_classes.

PARAMETERS p_file TYPE zaplink_file=&gt;t_filename.
PARAMETERS uninst TYPE flag AS CHECKBOX.

DATA o_file     TYPE REF TO zaplink_file.
DATA cx_file    TYPE REF TO zaplink_cx_file.

INITIALIZATION.
  TRY.
      CREATE OBJECT o_file.
      o_file-&gt;set_filetype( zaplink_file=&gt;filetypes-local ).
    CATCH zaplink_cx_file INTO cx_file.
      cx_file-&gt;write( ).
  ENDTRY.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR p_file.
  TRY.
      o_file-&gt;load_dialog( p_file ).
      p_file = o_file-&gt;get_filename( ).
    CATCH zaplink_cx_file INTO cx_file.
      IF cx_file-&gt;textid &lt;&gt; zaplink_cx_file=&gt;dialog_canceled.
        cx_file-&gt;write( ).
      ENDIF.
  ENDTRY.

START-OF-SELECTION.
  DATA o_list     TYPE zaplink_container_4inst=&gt;to_list.
  DATA cx_list    TYPE REF TO zaplink_cx_list.
  DATA o_xml     	TYPE REF TO zaplink_container_4inst.
  DATA cx_xml     TYPE REF TO zaplink_cx_container.
  DATA o_options  TYPE REF TO zaplink_options.
  DATA o_opt_devc TYPE REF TO zaplink_opt_devclass.

  TRY.
      o_file-&gt;set_filename( p_file ).
    CATCH zaplink_cx_file INTO cx_file.
      cx_file-&gt;write( ).
  ENDTRY.

  TRY.
      CREATE OBJECT o_options.
      CREATE OBJECT o_opt_devc.
      o_opt_devc-&gt;set_substitutionkind( zaplink_opt_devclass=&gt;substitutionkinds-no_overwrite ).
      o_options-&gt;set_devclass( o_opt_devc ).
      o_file-&gt;set_filename( p_file ).
    CATCH zaplink_cx_file INTO cx_file.
      cx_file-&gt;write( ).
  ENDTRY.

  TRY.
      CREATE OBJECT o_xml
        EXPORTING
          o_file = o_file.
      o_xml-&gt;set_options( o_options ).
      o_xml-&gt;load_from_file( ).
      TRY.
          o_list = o_xml-&gt;get_content( ).
          IF uninst IS INITIAL.
            o_list-&gt;select_default( zaplink_list=&gt;sel_actions-import ).
          ELSE.
            o_list-&gt;select_default( zaplink_list=&gt;sel_actions-uninstall ).
          ENDIF.
          o_list-&gt;change_selection( ).
        CATCH zaplink_cx_list INTO cx_list.
          cx_list-&gt;write( ).
      ENDTRY.
      IF uninst IS INITIAL.
        o_xml-&gt;transport_to_sap( o_list ).
      ELSE.
        o_xml-&gt;uninstall_from_sap( o_list ).
      ENDIF.
      o_xml-&gt;log-&gt;write( ).
    CATCH zaplink_cx_container INTO cx_xml.
      cx_xml-&gt;write( ).
  ENDTRY.

END-OF-SELECTION.</SOURCE>
  <TEXTSPOOL>
   <ITEM ID="R">
    <TEXTS>
     <ITEM LANGU="E" ENTRY="ZAP Link Installer Master" LENGTH="25 "/>
    </TEXTS>
   </ITEM>
  </TEXTSPOOL>
 </RAW>
</ZL_OBJECT>
